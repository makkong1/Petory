# 4. ì„±ëŠ¥ ìµœì í™”

## Q4-1. Board ë„ë©”ì¸ì—ì„œ 301ê°œ ì¿¼ë¦¬ë¥¼ 3ê°œë¡œ ì¤„ì¸ ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.

### ë‹µë³€ í¬ì¸íŠ¸
- **ë¬¸ì œ**: ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ ì‹œ ì‘ì„±ì, ë°˜ì‘ ì •ë³´, ì²¨ë¶€íŒŒì¼ì„ ê°œë³„ ì¿¼ë¦¬ë¡œ ì¡°íšŒ
- **í•´ê²°**:
  1. Fetch Joinìœ¼ë¡œ ì‘ì„±ì ì •ë³´ í•¨ê»˜ ì¡°íšŒ
  2. ë°°ì¹˜ ì¡°íšŒë¡œ ë°˜ì‘ ì •ë³´ IN ì ˆ ì§‘ê³„
  3. ë°°ì¹˜ ì¡°íšŒë¡œ ì²¨ë¶€íŒŒì¼ ì •ë³´ ì¡°íšŒ
- **ê²°ê³¼**: 301ê°œ â†’ 3ê°œ ì¿¼ë¦¬ (99% ê°ì†Œ)

### ìƒì„¸ ë‹µë³€

#### 1. ë¬¸ì œ ìƒí™© ë¶„ì„
**ìœ„ì¹˜**: `domain/board/service/BoardService.java` (ìµœì í™” ì „)

**Before ìµœì í™” ì¿¼ë¦¬ ìˆ˜**:
```
1. ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ: 1ê°œ ì¿¼ë¦¬
2. ê° ê²Œì‹œê¸€ì˜ ì‘ì„±ì ì¡°íšŒ: 100ê°œ ì¿¼ë¦¬ (N+1 ë¬¸ì œ)
3. ê° ê²Œì‹œê¸€ì˜ ë°˜ì‘ ì •ë³´ ì¡°íšŒ: 100ê°œ ì¿¼ë¦¬
4. ê° ê²Œì‹œê¸€ì˜ ì²¨ë¶€íŒŒì¼ ì¡°íšŒ: 100ê°œ ì¿¼ë¦¬

ì´ 301ê°œ ì¿¼ë¦¬
```

#### 2. í•´ê²° ë°©ë²•

##### 2-1. Fetch Joinìœ¼ë¡œ ì‘ì„±ì ì •ë³´ ì¡°íšŒ
**ìœ„ì¹˜**: `domain/board/repository/SpringDataJpaBoardRepository.java`
**ë©”ì„œë“œ**: `findAllByIsDeletedFalseOrderByCreatedAtDesc()`

**ì „ì²´ íë¦„**:
```
BoardService.getAllBoards()
  â†“
BoardRepository.findAllByIsDeletedFalseOrderByCreatedAtDesc()
  â†“
JOIN FETCHë¡œ ì‘ì„±ì ì •ë³´ í•¨ê»˜ ì¡°íšŒ
  â†“
1ê°œ ì¿¼ë¦¬ë¡œ ê²Œì‹œê¸€ + ì‘ì„±ì ì •ë³´ ì¡°íšŒ
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/board/repository/SpringDataJpaBoardRepository.java
@Query("SELECT b FROM Board b JOIN FETCH b.user u " +
       "WHERE b.isDeleted = false AND u.isDeleted = false AND u.status = 'ACTIVE' " +
       "ORDER BY b.createdAt DESC")
List<Board> findAllByIsDeletedFalseOrderByCreatedAtDesc();
```

**íš¨ê³¼**: 100ê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬

##### 2-2. ë°°ì¹˜ ì¡°íšŒë¡œ ë°˜ì‘ ì •ë³´ ì¡°íšŒ
**ìœ„ì¹˜**: `domain/board/service/BoardService.java`
**ë©”ì„œë“œ**: `mapBoardsWithReactionsBatch()`

**ì „ì²´ íë¦„**:
```
ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ ì™„ë£Œ
  â†“
ê²Œì‹œê¸€ ID ë¦¬ìŠ¤íŠ¸ ì¶”ì¶œ
  â†“
BoardReactionRepository.findByBoardIdxIn(boardIds)
  â†“
IN ì ˆë¡œ ë°˜ì‘ ì •ë³´ í•œ ë²ˆì— ì¡°íšŒ
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/board/service/BoardService.java
private List<BoardDTO> mapBoardsWithReactionsBatch(List<Board> boards) {
    List<Long> boardIds = boards.stream()
        .map(Board::getIdx)
        .collect(Collectors.toList());
    
    // ë°°ì¹˜ ì¡°íšŒ: ë°˜ì‘ ì •ë³´
    Map<Long, List<BoardReaction>> reactionsMap = 
        boardReactionRepository.findByBoardIdxIn(boardIds)
            .stream()
            .collect(Collectors.groupingBy(BoardReaction::getBoardIdx));
    
    // ë§¤í•‘
    return boards.stream()
        .map(board -> boardConverter.toDTO(board, reactionsMap, filesMap))
        .collect(Collectors.toList());
}
```

**íš¨ê³¼**: 100ê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬

##### 2-3. ë°°ì¹˜ ì¡°íšŒë¡œ ì²¨ë¶€íŒŒì¼ ì •ë³´ ì¡°íšŒ
**ìœ„ì¹˜**: `domain/file/service/AttachmentFileService.java`

**ì „ì²´ íë¦„**:
```
ê²Œì‹œê¸€ ID ë¦¬ìŠ¤íŠ¸ ì¶”ì¶œ
  â†“
AttachmentFileService.getFilesByTargetIds(boardIds, FileTargetType.BOARD)
  â†“
IN ì ˆë¡œ ì²¨ë¶€íŒŒì¼ ì •ë³´ í•œ ë²ˆì— ì¡°íšŒ
```

**íš¨ê³¼**: 100ê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬

#### 3. ìµœì¢… ê²°ê³¼
**After ìµœì í™” ì¿¼ë¦¬ ìˆ˜**:
```
1. ê²Œì‹œê¸€ + ì‘ì„±ì ì¡°íšŒ (Fetch Join): 1ê°œ ì¿¼ë¦¬
2. ë°˜ì‘ ì •ë³´ ë°°ì¹˜ ì¡°íšŒ (IN ì ˆ): 1ê°œ ì¿¼ë¦¬
3. ì²¨ë¶€íŒŒì¼ ë°°ì¹˜ ì¡°íšŒ (IN ì ˆ): 1ê°œ ì¿¼ë¦¬

ì´ 3ê°œ ì¿¼ë¦¬
```

**ì„±ëŠ¥ ê°œì„ **:
- ì¿¼ë¦¬ ìˆ˜: 301ê°œ â†’ 3ê°œ (**99% ê°ì†Œ**)
- ì‹¤í–‰ ì‹œê°„: 745ms â†’ 30ms (**24.83ë°° ê°œì„ **)

---

## Q4-2. ì¸ê¸°ê¸€ ìŠ¤ëƒ…ìƒ· íŒ¨í„´ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.

### ë‹µë³€ í¬ì¸íŠ¸
- ë³µì¡í•œ ê³„ì‚° ê²°ê³¼ë¥¼ ë¯¸ë¦¬ ìƒì„±í•˜ì—¬ ì €ì¥
- ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ ì£¼ê¸°ì ìœ¼ë¡œ ìŠ¤ëƒ…ìƒ· ìƒì„±
- ì¡°íšŒ ì‹œ ë³µì¡í•œ ê³„ì‚° ì—†ì´ ìŠ¤ëƒ…ìƒ· ì¡°íšŒ
- ì‹¤ì‹œê°„ì„±ê³¼ ì„±ëŠ¥ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„

### ìƒì„¸ ë‹µë³€

#### 1. ìŠ¤ëƒ…ìƒ· íŒ¨í„´ ê°œë…
**ìœ„ì¹˜**: `domain/board/service/BoardPopularityService.java`
**ì—”í‹°í‹°**: `domain/board/entity/BoardPopularitySnapshot.java`

**ì „ì²´ íë¦„**:
```
ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰ (ë§¤ì¼ 18:30, ë§¤ì£¼ ì›”ìš”ì¼ 18:30)
  â†“
BoardPopularityService.generateSnapshots()
  â†“
ì¸ê¸°ê¸€ ê³„ì‚° (ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, ëŒ“ê¸€ ìˆ˜ ë“±)
  â†“
BoardPopularitySnapshot ì—”í‹°í‹°ë¡œ ì €ì¥
  â†“
ì¡°íšŒ ì‹œ ìŠ¤ëƒ…ìƒ· í…Œì´ë¸”ì—ì„œ ì¡°íšŒ
```

#### 2. ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •
**ìœ„ì¹˜**: `domain/board/service/BoardPopularityScheduler.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// ë§¤ì¼ ì˜¤í›„ 6ì‹œ 30ë¶„ì— ì£¼ê°„ ì¸ê¸°ê¸€ ìŠ¤ëƒ…ìƒ· ìƒì„±
@Scheduled(cron = "0 30 18 * * ?")
@Transactional
public void generateWeeklyPopularitySnapshots() {
    boardPopularityService.generateSnapshots(PopularityPeriodType.WEEKLY);
}

// ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤í›„ 6ì‹œ 30ë¶„ì— ì›”ê°„ ì¸ê¸°ê¸€ ìŠ¤ëƒ…ìƒ· ìƒì„±
@Scheduled(cron = "0 30 18 ? * MON")
@Transactional
public void generateMonthlyPopularitySnapshots() {
    boardPopularityService.generateSnapshots(PopularityPeriodType.MONTHLY);
}
```

#### 3. ìŠ¤ëƒ…ìƒ· ìƒì„± ë¡œì§
**ìœ„ì¹˜**: `domain/board/service/BoardPopularityService.java`
**ë©”ì„œë“œ**: `generateSnapshots()`

**ì „ì²´ íë¦„**:
```
ê¸°ê°„ ì„¤ì • (ì£¼ê°„/ì›”ê°„)
  â†“
ê¸°ê°„ ë‚´ ê²Œì‹œê¸€ ì¡°íšŒ
  â†“
ì¸ê¸° ì ìˆ˜ ê³„ì‚° (ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, ëŒ“ê¸€ ìˆ˜ ê°€ì¤‘ì¹˜ ì ìš©)
  â†“
ìƒìœ„ Nê°œ ì„ ì •
  â†“
BoardPopularitySnapshot ì—”í‹°í‹° ìƒì„± ë° ì €ì¥
```

**ì¸ê¸° ì ìˆ˜ ê³„ì‚° ê³µì‹**:
```
ì¸ê¸° ì ìˆ˜ = (ì¡°íšŒìˆ˜ Ã— 1) + (ì¢‹ì•„ìš” Ã— 2) + (ëŒ“ê¸€ ìˆ˜ Ã— 3)
```

#### 4. ìŠ¤ëƒ…ìƒ· ì¡°íšŒ
**ìœ„ì¹˜**: `domain/board/repository/BoardPopularitySnapshotRepository.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
@Query("SELECT s FROM BoardPopularitySnapshot s " +
       "WHERE s.periodType = :periodType " +
       "ORDER BY s.popularityScore DESC")
List<BoardPopularitySnapshot> findByPeriodTypeOrderByPopularityScoreDesc(
    PopularityPeriodType periodType);
```

**íš¨ê³¼**:
- ë³µì¡í•œ ê³„ì‚° ì—†ì´ ë‹¨ìˆœ ì¡°íšŒ
- ì¡°íšŒ ì„±ëŠ¥ ëŒ€í­ í–¥ìƒ
- ì‹¤ì‹œê°„ì„±ì€ ì•½ê°„ ë–¨ì–´ì§€ì§€ë§Œ ì„±ëŠ¥ ìš°ì„ 

---

## Q4-3. Redis ìºì‹± ì „ëµì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.

### ë‹µë³€ í¬ì¸íŠ¸
- ì•Œë¦¼ ìµœì‹  50ê°œë¥¼ Redisì— ì €ì¥ (TTL 24ì‹œê°„)
- ì¸ê¸°ê¸€ ìŠ¤ëƒ…ìƒ· ìºì‹±
- ìœ„ì¹˜ ì„œë¹„ìŠ¤ ë°ì´í„° ìºì‹±
- Spring Cache ì–´ë…¸í…Œì´ì…˜ í™œìš© (@Cacheable, @CacheEvict)

### ìƒì„¸ ë‹µë³€

#### 1. Redis ì„¤ì •
**ìœ„ì¹˜**: `application.properties`

**ì„¤ì •**:
```properties
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.cache.type=redis
```

**í™œì„±í™”**: `PetoryApplication.java`ì— `@EnableCaching` ì–´ë…¸í…Œì´ì…˜

#### 2. ì•Œë¦¼ ìºì‹±
**ìœ„ì¹˜**: `domain/notification/service/NotificationService.java`

**ì „ëµ**:
- ìµœì‹  50ê°œ ì•Œë¦¼ì„ Redisì— ì €ì¥
- TTL: 24ì‹œê°„
- ì½ìŒ ì²˜ë¦¬ ì‹œ ìºì‹œ ì—…ë°ì´íŠ¸

**ì „ì²´ íë¦„**:
```
ì•Œë¦¼ ìƒì„±
  â†“
MySQLì— ì €ì¥
  â†“
Redisì— ìµœì‹  50ê°œ ì—…ë°ì´íŠ¸
  â†“
ì¡°íšŒ ì‹œ Redisì—ì„œ ë¨¼ì € ì¡°íšŒ
  â†“
ì—†ìœ¼ë©´ MySQLì—ì„œ ì¡°íšŒ
```

#### 3. ì¸ê¸°ê¸€ ìŠ¤ëƒ…ìƒ· ìºì‹±
**ìœ„ì¹˜**: `domain/board/service/BoardService.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
@Cacheable(value = "boardDetail", key = "#idx")
public BoardDTO getBoard(long idx, Long viewerId) {
    // ...
}

@CacheEvict(value = "boardDetail", key = "#idx")
public BoardDTO updateBoard(long idx, BoardDTO dto) {
    // ...
}
```

**ìºì‹œ ì „ëµ**:
- ì¡°íšŒ: `@Cacheable` - ìºì‹œì— ìˆìœ¼ë©´ ë°˜í™˜, ì—†ìœ¼ë©´ ì¡°íšŒ í›„ ìºì‹œ ì €ì¥
- ìˆ˜ì •/ì‚­ì œ: `@CacheEvict` - ìºì‹œ ë¬´íš¨í™”

#### 4. ìœ„ì¹˜ ì„œë¹„ìŠ¤ ìºì‹±
**ìœ„ì¹˜**: `domain/location/service/LocationServiceService.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
@Cacheable(value = "popularLocationServices", key = "#category")
public List<LocationServiceDTO> getPopularLocationServices(String category) {
    return locationServiceRepository.findTop10ByCategoryOrderByRatingDesc(category)
        .stream()
        .map(locationServiceConverter::toDTO)
        .collect(Collectors.toList());
}
```

**íš¨ê³¼**:
- ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„° ìºì‹±
- DB ë¶€í•˜ ê°ì†Œ
- ì‘ë‹µ ì‹œê°„ ë‹¨ì¶•

---

## Q4-4. Location ë„ë©”ì¸ì—ì„œ ì´ˆê¸° ë¡œë“œ ì„±ëŠ¥ì„ ì–´ë–»ê²Œ ê°œì„ í–ˆë‚˜ìš”?

### ë‹µë³€ í¬ì¸íŠ¸
- **ë¬¸ì œ**: ì´ˆê¸° ë¡œë“œ ì‹œ ì „ì²´ ë°ì´í„°(22,699ê°œ) ì¡°íšŒ
- **í•´ê²°**: ì‚¬ìš©ì ìœ„ì¹˜ ê¸°ë°˜ 10km ë°˜ê²½ ê²€ìƒ‰
- **ê²°ê³¼**: 22,699ê°œ â†’ 1,026ê°œ (95.5% ê°ì†Œ)

### ìƒì„¸ ë‹µë³€

#### 1. ë¬¸ì œ ìƒí™©
**Before ìµœì í™”**:
- ì´ˆê¸° ë¡œë“œ ì‹œ ì „ì²´ ìœ„ì¹˜ ì„œë¹„ìŠ¤ ì¡°íšŒ: 22,699ê°œ
- ë¶ˆí•„ìš”í•œ ë°ì´í„°ê¹Œì§€ ì¡°íšŒ
- ì´ˆê¸° ë¡œë“œ ì‹œê°„: ëŠë¦¼

#### 2. í•´ê²° ë°©ë²•
**ìœ„ì¹˜**: `domain/location/service/LocationServiceService.java`
**ë©”ì„œë“œ**: `searchLocationServicesByLocation()`

**ì „ì²´ íë¦„**:
```
ì‚¬ìš©ì ìœ„ì¹˜ ì •ë³´ ìˆ˜ì‹  (ìœ„ë„, ê²½ë„)
  â†“
LocationServiceService.searchLocationServicesByLocation()
  â†“
LocationServiceRepository.findByRadius()
  â†“
ST_Distance_Sphereë¡œ 10km ë°˜ê²½ ê³„ì‚°
  â†“
ë°˜ê²½ ë‚´ ìœ„ì¹˜ ì„œë¹„ìŠ¤ë§Œ ì¡°íšŒ
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/location/service/LocationServiceService.java
public List<LocationServiceDTO> searchLocationServicesByLocation(
        Double latitude, Double longitude,
        Integer radiusInMeters, String category, Integer maxResults) {
    
    // ë°˜ê²½ ê²€ìƒ‰ ìˆ˜í–‰
    List<LocationService> services = locationServiceRepository
            .findByRadius(latitude, longitude, (double) radiusInMeters);
    
    // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
    if (StringUtils.hasText(category)) {
        services = services.stream()
            .filter(service -> {
                // category3, category2, category1 ìˆœì„œë¡œ í™•ì¸
                // ...
            })
            .collect(Collectors.toList());
    }
    
    return services.stream()
        .map(locationServiceConverter::toDTO)
        .collect(Collectors.toList());
}
```

**ST_Distance_Sphere ì¿¼ë¦¬**:
```java
// domain/location/repository/SpringDataJpaLocationServiceRepository.java
@Query(value = "SELECT * FROM locationservice WHERE " +
               "latitude IS NOT NULL AND longitude IS NOT NULL AND " +
               "ST_Distance_Sphere(POINT(longitude, latitude), POINT(?2, ?1)) <= ?3 AND " +
               "(is_deleted IS NULL OR is_deleted = 0) " +
               "ORDER BY rating DESC", 
       nativeQuery = true)
List<LocationService> findByRadius(Double latitude, Double longitude, Double radiusInMeters);
```

#### 3. ìµœì¢… ê²°ê³¼
**After ìµœì í™”**:
- ì‚¬ìš©ì ìœ„ì¹˜ ê¸°ì¤€ 10km ë°˜ê²½: 1,026ê°œ
- **95.5% ë°ì´í„° ê°ì†Œ**
- ì´ˆê¸° ë¡œë“œ ì‹œê°„: ëŒ€í­ ê°œì„ 

---

## Q4-5. ë°°ì¹˜ ì¡°íšŒ(Batch Query)ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í–ˆë‚˜ìš”?

### ë‹µë³€ í¬ì¸íŠ¸
- IN ì ˆì„ í™œìš©í•œ ì§‘ê³„ ì¿¼ë¦¬
- 500ê°œ ë‹¨ìœ„ë¡œ ë°°ì¹˜ ì²˜ë¦¬í•˜ì—¬ IN ì ˆ í¬ê¸° ì œí•œ
- ì˜ˆì‹œ: ë°˜ì‘ ì •ë³´ ë°°ì¹˜ ì¡°íšŒë¡œ 100ê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬

### ìƒì„¸ ë‹µë³€

#### 1. ë°°ì¹˜ ì¡°íšŒ ê°œë…
**ìœ„ì¹˜**: `domain/board/service/BoardService.java`
**ë©”ì„œë“œ**: `mapBoardsWithReactionsBatch()`

**ì „ì²´ íë¦„**:
```
ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ ì™„ë£Œ
  â†“
ê²Œì‹œê¸€ ID ë¦¬ìŠ¤íŠ¸ ì¶”ì¶œ
  â†“
IN ì ˆë¡œ ì—°ê´€ ë°ì´í„° ë°°ì¹˜ ì¡°íšŒ
  â†“
ë©”ëª¨ë¦¬ì—ì„œ ë§¤í•‘
```

#### 2. ë°˜ì‘ ì •ë³´ ë°°ì¹˜ ì¡°íšŒ
**ìœ„ì¹˜**: `domain/board/repository/BoardReactionRepository.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/board/service/BoardService.java
List<Long> boardIds = boards.stream()
    .map(Board::getIdx)
    .collect(Collectors.toList());

// ë°°ì¹˜ ì¡°íšŒ: ë°˜ì‘ ì •ë³´
Map<Long, List<BoardReaction>> reactionsMap = 
    boardReactionRepository.findByBoardIdxIn(boardIds)
        .stream()
        .collect(Collectors.groupingBy(BoardReaction::getBoardIdx));
```

**Repository ì¿¼ë¦¬**:
```java
// domain/board/repository/SpringDataJpaBoardReactionRepository.java
@Query("SELECT br FROM BoardReaction br WHERE br.board.idx IN :boardIds")
List<BoardReaction> findByBoardIdxIn(@Param("boardIds") List<Long> boardIds);
```

**íš¨ê³¼**: 100ê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬

#### 3. ë°°ì¹˜ í¬ê¸° ì œí•œ
**ì£¼ì˜ì‚¬í•­**: IN ì ˆ í¬ê¸° ì œí•œ

**í•´ê²° ë°©ë²•**:
- 500ê°œ ë‹¨ìœ„ë¡œ ë°°ì¹˜ ì²˜ë¦¬
- í° ë¦¬ìŠ¤íŠ¸ëŠ” ì—¬ëŸ¬ ë²ˆ ë‚˜ëˆ ì„œ ì¡°íšŒ

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// 500ê°œ ë‹¨ìœ„ë¡œ ë°°ì¹˜ ì²˜ë¦¬
int batchSize = 500;
List<List<Long>> batches = new ArrayList<>();
for (int i = 0; i < boardIds.size(); i += batchSize) {
    batches.add(boardIds.subList(i, Math.min(i + batchSize, boardIds.size())));
}

Map<Long, List<BoardReaction>> reactionsMap = new HashMap<>();
for (List<Long> batch : batches) {
    boardReactionRepository.findByBoardIdxIn(batch)
        .forEach(reaction -> {
            reactionsMap.computeIfAbsent(reaction.getBoardIdx(), k -> new ArrayList<>())
                .add(reaction);
        });
}
```

#### 4. ì²¨ë¶€íŒŒì¼ ë°°ì¹˜ ì¡°íšŒ
**ìœ„ì¹˜**: `domain/file/service/AttachmentFileService.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/board/service/BoardService.java
Map<Long, List<FileDTO>> filesMap = 
    attachmentFileService.getFilesByTargetIds(boardIds, FileTargetType.BOARD);
```

**íš¨ê³¼**: 100ê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬

---

## ğŸ“ í•µì‹¬ ì •ë¦¬

### Board ë„ë©”ì¸ ìµœì í™”
- **Fetch Join**: ì‘ì„±ì ì •ë³´ í•¨ê»˜ ì¡°íšŒ
- **ë°°ì¹˜ ì¡°íšŒ**: ë°˜ì‘ ì •ë³´, ì²¨ë¶€íŒŒì¼ IN ì ˆ ì¡°íšŒ
- **ê²°ê³¼**: 301ê°œ ì¿¼ë¦¬ â†’ 3ê°œ ì¿¼ë¦¬ (99% ê°ì†Œ)

### ìŠ¤ëƒ…ìƒ· íŒ¨í„´
- **ëª©ì **: ë³µì¡í•œ ê³„ì‚° ì‚¬ì „ ìˆ˜í–‰
- **ìŠ¤ì¼€ì¤„**: ë§¤ì¼ 18:30, ë§¤ì£¼ ì›”ìš”ì¼ 18:30
- **íš¨ê³¼**: ì¡°íšŒ ì„±ëŠ¥ ëŒ€í­ í–¥ìƒ

### Redis ìºì‹±
- **ì•Œë¦¼**: ìµœì‹  50ê°œ, TTL 24ì‹œê°„
- **ì¸ê¸°ê¸€**: `@Cacheable`, `@CacheEvict` í™œìš©
- **ìœ„ì¹˜ ì„œë¹„ìŠ¤**: ì¹´í…Œê³ ë¦¬ë³„ ì¸ê¸° ì„œë¹„ìŠ¤ ìºì‹±

### Location ë„ë©”ì¸ ìµœì í™”
- **ST_Distance_Sphere**: ìœ„ì¹˜ ê¸°ë°˜ ë°˜ê²½ ê²€ìƒ‰
- **ê²°ê³¼**: 22,699ê°œ â†’ 1,026ê°œ (95.5% ê°ì†Œ)

### ë°°ì¹˜ ì¡°íšŒ
- **IN ì ˆ í™œìš©**: ì—°ê´€ ë°ì´í„° í•œ ë²ˆì— ì¡°íšŒ
- **ë°°ì¹˜ í¬ê¸°**: 500ê°œ ë‹¨ìœ„ ì œí•œ
- **íš¨ê³¼**: Nê°œ ì¿¼ë¦¬ â†’ 1ê°œ ì¿¼ë¦¬
