# 6. ë³´ì•ˆ & ì¸ì¦

## Q6-1. JWT í† í° ê¸°ë°˜ ì¸ì¦ ë°©ì‹ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.

### ë‹µë³€ í¬ì¸íŠ¸
- Access Token (15ë¶„) + Refresh Token (1ì¼)
- Access Token ë§Œë£Œ ì‹œ Refresh Tokenìœ¼ë¡œ ê°±ì‹ 
- JwtAuthenticationFilterì—ì„œ í† í° ê²€ì¦
- í† í°ì— ì‚¬ìš©ì ì •ë³´ í¬í•¨ (idx, role ë“±)

### ìƒì„¸ ë‹µë³€

#### 1. JWT í† í° êµ¬ì¡°
**ìœ„ì¹˜**: `util/JwtUtil.java`

**í† í° êµ¬ì„±**:
- **Header**: ì•Œê³ ë¦¬ì¦˜ ì •ë³´ (HS256)
- **Payload**: ì‚¬ìš©ì ì •ë³´ (idx, id, role ë“±)
- **Signature**: ì„œëª… (ë¹„ë°€í‚¤ë¡œ ìƒì„±)

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// util/JwtUtil.java
public String generateToken(String id, Long idx, String role) {
    Map<String, Object> claims = new HashMap<>();
    claims.put("idx", idx);
    claims.put("role", role);
    
    return Jwts.builder()
        .setClaims(claims)
        .setSubject(id)
        .setIssuedAt(new Date())
        .setExpiration(new Date(System.currentTimeMillis() + jwtExpiration))
        .signWith(SignatureAlgorithm.HS256, secretKey)
        .compact();
}
```

#### 2. Access Tokenê³¼ Refresh Token
**ìœ„ì¹˜**: `domain/user/service/AuthService.java`

**Access Token**:
- ë§Œë£Œ ì‹œê°„: 15ë¶„ (86400000ms)
- ìš©ë„: API ìš”ì²­ ì¸ì¦
- ì €ì¥ ìœ„ì¹˜: í´ë¼ì´ì–¸íŠ¸ ë©”ëª¨ë¦¬ ë˜ëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€

**Refresh Token**:
- ë§Œë£Œ ì‹œê°„: 1ì¼
- ìš©ë„: Access Token ê°±ì‹ 
- ì €ì¥ ìœ„ì¹˜: DB (Users.refreshToken)

**ì „ì²´ íë¦„**:
```
ë¡œê·¸ì¸ ì„±ê³µ
  â†“
Access Token + Refresh Token ìƒì„±
  â†“
Access Token: í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜
Refresh Token: DBì— ì €ì¥
  â†“
API ìš”ì²­ ì‹œ Access Token ì‚¬ìš©
  â†“
Access Token ë§Œë£Œ ì‹œ
  â†“
Refresh Tokenìœ¼ë¡œ ìƒˆ Access Token ë°œê¸‰
```

#### 3. JWT í•„í„°ì—ì„œ í† í° ê²€ì¦
**ìœ„ì¹˜**: `filter/JwtAuthenticationFilter.java`
**ë©”ì„œë“œ**: `doFilterInternal()`

**ì „ì²´ íë¦„**:
```
ìš”ì²­ ìˆ˜ì‹ 
  â†“
JwtAuthenticationFilter.doFilterInternal()
  â†“
Authorization í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ
  â†“
JwtUtil.validateToken() ê²€ì¦
  â†“
í† í° ë§Œë£Œ í™•ì¸
  â†“
UserDetailsService.loadUserByUsername() ì‚¬ìš©ì ì¡°íšŒ
  â†“
SecurityContextì— ì¸ì¦ ì •ë³´ ì €ì¥
  â†“
ë‹¤ìŒ í•„í„°ë¡œ ì „ë‹¬
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// filter/JwtAuthenticationFilter.java
@Override
protected void doFilterInternal(HttpServletRequest request,
        HttpServletResponse response,
        FilterChain filterChain) {
    
    String token = null;
    
    // í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ
    String authorizationHeader = request.getHeader("Authorization");
    if (authorizationHeader != null && authorizationHeader.startsWith("Bearer ")) {
        token = jwtUtil.extractTokenFromHeader(authorizationHeader);
    }
    
    // ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì—ì„œ í† í° ì¶”ì¶œ (SSE ë“±)
    if (token == null) {
        token = request.getParameter("token");
    }
    
    if (token != null && jwtUtil.validateToken(token)) {
        String id = jwtUtil.getIdFromToken(token);
        
        if (id != null && SecurityContextHolder.getContext().getAuthentication() == null) {
            UserDetails userDetails = userDetailsService.loadUserByUsername(id);
            
            if (jwtUtil.validateToken(token) && !jwtUtil.isTokenExpired(token)) {
                UsernamePasswordAuthenticationToken authToken = 
                    new UsernamePasswordAuthenticationToken(
                        userDetails, null, userDetails.getAuthorities());
                
                SecurityContextHolder.getContext().setAuthentication(authToken);
            }
        }
    }
    
    filterChain.doFilter(request, response);
}
```

#### 4. í† í° ê°±ì‹ 
**ìœ„ì¹˜**: `domain/user/controller/AuthController.java`

**ì „ì²´ íë¦„**:
```
Access Token ë§Œë£Œ
  â†“
Refresh Tokenìœ¼ë¡œ ê°±ì‹  ìš”ì²­
  â†“
Refresh Token ê²€ì¦
  â†“
DBì—ì„œ ì‚¬ìš©ì ì¡°íšŒ (Refresh Tokenìœ¼ë¡œ)
  â†“
ìƒˆ Access Token ë°œê¸‰
  â†“
í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜
```

---

## Q6-2. OAuth2 ì†Œì…œ ë¡œê·¸ì¸ì„ ì–´ë–»ê²Œ êµ¬í˜„í–ˆë‚˜ìš”?

### ë‹µë³€ í¬ì¸íŠ¸
- Google, Naver ì§€ì›
- Spring Security OAuth2 Client í™œìš©
- Providerë³„ OAuth2UserServiceì—ì„œ í‘œì¤€í™”
- ê¸°ì¡´ ì‚¬ìš©ì ìë™ ì—°ê²°, ì‹ ê·œ ì‚¬ìš©ì ìë™ íšŒì›ê°€ì…

### ìƒì„¸ ë‹µë³€

#### 1. OAuth2 ì„¤ì •
**ìœ„ì¹˜**: `application.properties`

**Google ì„¤ì •**:
```properties
spring.security.oauth2.client.registration.google.client-id=...
spring.security.oauth2.client.registration.google.client-secret=...
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}
```

**Naver ì„¤ì •**:
```properties
spring.security.oauth2.client.registration.naver.client-id=...
spring.security.oauth2.client.registration.naver.client-secret=...
spring.security.oauth2.client.registration.naver.scope=name,email
spring.security.oauth2.client.provider.naver.authorization-uri=https://nid.naver.com/oauth2.0/authorize
spring.security.oauth2.client.provider.naver.token-uri=https://nid.naver.com/oauth2.0/token
spring.security.oauth2.client.provider.naver.user-info-uri=https://openapi.naver.com/v1/nid/me
```

#### 2. Providerë³„ ì»¤ìŠ¤í…€ í´ë¼ì´ì–¸íŠ¸
**ìœ„ì¹˜**: `domain/user/service/ConditionalOAuth2TokenResponseClient.java`

**ì „ì²´ íë¦„**:
```
OAuth2 ì¸ì¦ ìš”ì²­
  â†“
ConditionalOAuth2TokenResponseClient.getTokenResponse()
  â†“
Provider í™•ì¸ (naver / google)
  â†“
Naver: NaverOAuth2TokenResponseClient ì‚¬ìš©
Google: RestClientAuthorizationCodeTokenResponseClient ì‚¬ìš©
  â†“
í† í° ë°œê¸‰
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/service/ConditionalOAuth2TokenResponseClient.java
@Override
public OAuth2AccessTokenResponse getTokenResponse(
        OAuth2AuthorizationCodeGrantRequest authorizationCodeGrantRequest) {
    
    String registrationId = authorizationCodeGrantRequest.getClientRegistration().getRegistrationId();
    
    // Naverì¸ ê²½ìš° ì»¤ìŠ¤í…€ í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©
    if ("naver".equalsIgnoreCase(registrationId)) {
        return naverClient.getTokenResponse(authorizationCodeGrantRequest);
    }
    
    // Google ë“± ë‹¤ë¥¸ providerëŠ” ê¸°ë³¸ í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©
    return getDefaultClient().getTokenResponse(authorizationCodeGrantRequest);
}
```

#### 3. OAuth2UserService
**ìœ„ì¹˜**: `domain/user/service/OAuth2UserService.java`

**ì „ì²´ íë¦„**:
```
ì†Œì…œ ë¡œê·¸ì¸ ì½œë°±
  â†“
OAuth2UserService.loadUser()
  â†“
Providerë³„ ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ
  â†“
ê¸°ì¡´ ì‚¬ìš©ì í™•ì¸ (email ë˜ëŠ” providerId)
  â†“
ìˆìœ¼ë©´: ê¸°ì¡´ ê³„ì • ë°˜í™˜
ì—†ìœ¼ë©´: ìƒˆ ê³„ì • ìƒì„± í›„ ë°˜í™˜
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/service/OAuth2UserService.java
@Override
public OAuth2User loadUser(OAuth2UserRequest userRequest) throws OAuth2AuthenticationException {
    OAuth2User oAuth2User = super.loadUser(userRequest);
    
    String registrationId = userRequest.getClientRegistration().getRegistrationId();
    
    // Providerë³„ ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ
    Map<String, Object> attributes = oAuth2User.getAttributes();
    
    // ê¸°ì¡´ ì‚¬ìš©ì í™•ì¸
    Users user = processOAuth2User(userRequest, oAuth2User);
    
    return new DefaultOAuth2User(
        user.getAuthorities(),
        attributes,
        "id"
    );
}
```

#### 4. ìë™ íšŒì›ê°€ì…
**ìœ„ì¹˜**: `domain/user/service/OAuth2UserService.java`
**ë©”ì„œë“œ**: `processOAuth2User()`

**ì „ì²´ íë¦„**:
```
ì†Œì…œ ê³„ì • ì •ë³´ ì¶”ì¶œ
  â†“
SocialUser ì¡°íšŒ ì‹œë„
  â†“
ì—†ìœ¼ë©´: ìƒˆ ê³„ì • ìƒì„±
  - Users ì—”í‹°í‹° ìƒì„±
  - SocialUser ì—”í‹°í‹° ìƒì„±
  - ì´ë©”ì¼ ì¸ì¦ ìë™ ì™„ë£Œ
  â†“
ìˆìœ¼ë©´: ê¸°ì¡´ ê³„ì • ë°˜í™˜
```

---

## Q6-3. ì´ë©”ì¼ ì¸ì¦ ì‹œìŠ¤í…œì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.

### ë‹µë³€ í¬ì¸íŠ¸
- ë‹¨ì¼ ì´ë©”ì¼ ì¸ì¦ ì‹œìŠ¤í…œ
- Redisì— ì„ì‹œ ì¸ì¦ ì •ë³´ ì €ì¥
- ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ í›„ ì„œë¹„ìŠ¤ ì´ìš© ê°€ëŠ¥
- ì†Œì…œ ë¡œê·¸ì¸ ì‹œ ìë™ ì¸ì¦ ì™„ë£Œ

### ìƒì„¸ ë‹µë³€

#### 1. ì´ë©”ì¼ ì¸ì¦ í† í° ìƒì„±
**ìœ„ì¹˜**: `domain/user/service/EmailVerificationService.java`
**ë©”ì„œë“œ**: `sendVerificationEmail()`

**ì „ì²´ íë¦„**:
```
íšŒì›ê°€ì… ë˜ëŠ” ì´ë©”ì¼ ë³€ê²½
  â†“
ì¸ì¦ í† í° ìƒì„± (UUID)
  â†“
Redisì— ì €ì¥ (TTL: 24ì‹œê°„)
  â†“
ì´ë©”ì¼ ë°œì†¡
  â†“
ì‚¬ìš©ìê°€ ë§í¬ í´ë¦­
  â†“
í† í° ê²€ì¦ ë° ì¸ì¦ ì™„ë£Œ
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/service/EmailVerificationService.java
public void sendVerificationEmail(Long userId, EmailVerificationPurpose purpose) {
    String token = UUID.randomUUID().toString();
    
    // Redisì— ì €ì¥
    String key = "email_verification:" + token;
    EmailVerificationData data = EmailVerificationData.builder()
        .userId(userId)
        .purpose(purpose)
        .build();
    
    redisTemplate.opsForValue().set(key, data, 24, TimeUnit.HOURS);
    
    // ì´ë©”ì¼ ë°œì†¡
    emailService.sendVerificationEmail(user.getEmail(), token, purpose);
}
```

#### 2. ì´ë©”ì¼ ì¸ì¦ í™•ì¸
**ìœ„ì¹˜**: `domain/user/service/EmailVerificationService.java`
**ë©”ì„œë“œ**: `verifyEmail()`

**ì „ì²´ íë¦„**:
```
ì¸ì¦ ë§í¬ í´ë¦­
  â†“
í† í° ì¶”ì¶œ
  â†“
Redisì—ì„œ ì¸ì¦ ì •ë³´ ì¡°íšŒ
  â†“
í† í° ìœ íš¨ì„± í™•ì¸
  â†“
ì‚¬ìš©ì ì´ë©”ì¼ ì¸ì¦ ìƒíƒœ ì—…ë°ì´íŠ¸
  â†“
Redisì—ì„œ í† í° ì‚­ì œ
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/service/EmailVerificationService.java
public void verifyEmail(String token) {
    String key = "email_verification:" + token;
    EmailVerificationData data = (EmailVerificationData) redisTemplate.opsForValue().get(key);
    
    if (data == null) {
        throw new IllegalArgumentException("ìœ íš¨í•˜ì§€ ì•Šì€ ì¸ì¦ í† í°ì…ë‹ˆë‹¤.");
    }
    
    Users user = usersRepository.findById(data.getUserId())
        .orElseThrow(() -> new IllegalArgumentException("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."));
    
    user.setEmailVerified(true);
    usersRepository.save(user);
    
    redisTemplate.delete(key);
}
```

#### 3. ì¸ì¦ í•„ìš” ê¸°ëŠ¥ ì œí•œ
**ìœ„ì¹˜**: `domain/user/exception/EmailVerificationRequiredException.java`

**ì‚¬ìš© ì˜ˆì‹œ**:
```java
// domain/board/service/BoardService.java
if (user.getEmailVerified() == null || !user.getEmailVerified()) {
    throw new EmailVerificationRequiredException(
        "ê²Œì‹œê¸€ ì‘ì„±ì„ ìœ„í•´ ì´ë©”ì¼ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        EmailVerificationPurpose.BOARD_CREATE);
}
```

---

## Q6-4. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ë°©ì‹ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.

### ë‹µë³€ í¬ì¸íŠ¸
- BCryptPasswordEncoder ì‚¬ìš©
- Salt ìë™ ìƒì„±
- ë‹¨ë°©í–¥ í•´ì‹œ í•¨ìˆ˜

### ìƒì„¸ ë‹µë³€

#### 1. BCrypt ì„¤ì •
**ìœ„ì¹˜**: `global/security/SecurityConfig.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
@Bean
public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
}
```

#### 2. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
**ìœ„ì¹˜**: `domain/user/service/AuthService.java`

**ì „ì²´ íë¦„**:
```
íšŒì›ê°€ì… ì‹œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
  â†“
BCryptPasswordEncoder.encode()
  â†“
Salt ìë™ ìƒì„± + í•´ì‹œ
  â†“
ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ DB ì €ì¥
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/service/AuthService.java
public Users register(String username, String password, String email) {
    String encodedPassword = passwordEncoder.encode(password);
    
    Users user = Users.builder()
        .username(username)
        .password(encodedPassword)
        .email(email)
        .build();
    
    return usersRepository.save(user);
}
```

#### 3. ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
**ìœ„ì¹˜**: `domain/user/service/AuthService.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/service/AuthService.java
public boolean authenticate(String username, String password) {
    Users user = usersRepository.findByUsername(username)
        .orElseThrow(() -> new IllegalArgumentException("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."));
    
    return passwordEncoder.matches(password, user.getPassword());
}
```

**BCrypt íŠ¹ì§•**:
- Salt ìë™ ìƒì„± (ê° ë¹„ë°€ë²ˆí˜¸ë§ˆë‹¤ ë‹¤ë¥¸ Salt)
- ë‹¨ë°©í–¥ í•´ì‹œ (ë³µí˜¸í™” ë¶ˆê°€ëŠ¥)
- ëŠë¦° í•´ì‹œ í•¨ìˆ˜ (ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ë°©ì§€)

---

## Q6-5. ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´(RBAC)ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í–ˆë‚˜ìš”?

### ë‹µë³€ í¬ì¸íŠ¸
- Role: USER, ADMIN, SERVICE_PROVIDER, MASTER
- @PreAuthorize ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ê¶Œí•œ ì²´í¬
- SecurityConfigì—ì„œ ê²½ë¡œë³„ ê¶Œí•œ ì„¤ì •

### ìƒì„¸ ë‹µë³€

#### 1. Role ì •ì˜
**ìœ„ì¹˜**: `domain/user/entity/Users.java`

**Role ì¢…ë¥˜**:
- `USER`: ì¼ë°˜ ì‚¬ìš©ì
- `ADMIN`: ê´€ë¦¬ì
- `SERVICE_PROVIDER`: ì„œë¹„ìŠ¤ ì œê³µì
- `MASTER`: ìµœê³  ê´€ë¦¬ì

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/user/entity/Users.java
@Enumerated(EnumType.STRING)
private Role role;
```

#### 2. SecurityConfig ì„¤ì •
**ìœ„ì¹˜**: `global/security/SecurityConfig.java`

**ì „ì²´ íë¦„**:
```
ìš”ì²­ ìˆ˜ì‹ 
  â†“
SecurityConfigì—ì„œ ê²½ë¡œë³„ ê¶Œí•œ ì²´í¬
  â†“
ê³µê°œ API: permitAll()
ë³´í˜¸ëœ API: authenticated()
ê´€ë¦¬ì API: hasRole('ADMIN')
  â†“
ê¶Œí•œ ì—†ìœ¼ë©´ 403 Forbidden
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// global/security/SecurityConfig.java
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    http
        .authorizeHttpRequests(auth -> auth
            .requestMatchers("/api/auth/**").permitAll()
            .requestMatchers("/api/public/**").permitAll()
            .requestMatchers("/api/admin/**").hasRole("ADMIN")
            .anyRequest().authenticated()
        );
    
    return http.build();
}
```

#### 3. ë©”ì„œë“œ ë ˆë²¨ ê¶Œí•œ ì²´í¬
**ìœ„ì¹˜**: `PetoryApplication.java` (`@EnableMethodSecurity`)

**ì‚¬ìš© ì˜ˆì‹œ**:
```java
// domain/admin/controller/AdminUserController.java
@PreAuthorize("hasRole('ADMIN')")
@GetMapping("/users")
public List<UserDTO> getAllUsers() {
    return userService.getAllUsers();
}
```

**í™œì„±í™”**:
```java
// PetoryApplication.java
@EnableMethodSecurity(prePostEnabled = true)
public class PetoryApplication {
    // ...
}
```

---

## Q6-6. SQL Injectionê³¼ XSS ê³µê²©ì„ ì–´ë–»ê²Œ ë°©ì§€í–ˆë‚˜ìš”?

### ë‹µë³€ í¬ì¸íŠ¸
- **SQL Injection**: JPA ì‚¬ìš©ìœ¼ë¡œ ìë™ ë°©ì§€ (PreparedStatement)
- **XSS**: DTO ë³€í™˜ ì‹œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
- ê²½ë¡œ ì •ê·œí™”ë¡œ Directory Traversal ê³µê²© ë°©ì§€

### ìƒì„¸ ë‹µë³€

#### 1. SQL Injection ë°©ì§€
**ë°©ë²•**: JPA ì‚¬ìš©

**ì „ì²´ íë¦„**:
```
JPA ì¿¼ë¦¬ ì‘ì„±
  â†“
JPQL ë˜ëŠ” ì¿¼ë¦¬ ë©”ì„œë“œ
  â†“
Hibernateê°€ PreparedStatementë¡œ ë³€í™˜
  â†“
íŒŒë¼ë¯¸í„° ë°”ì¸ë”©
  â†“
SQL Injection ìë™ ë°©ì§€
```

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// ì•ˆì „í•œ ë°©ë²•: íŒŒë¼ë¯¸í„° ë°”ì¸ë”©
@Query("SELECT b FROM Board b WHERE b.title = :title")
List<Board> findByTitle(@Param("title") String title);

// ìœ„í—˜í•œ ë°©ë²•: ë¬¸ìì—´ ì—°ê²° (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
// @Query("SELECT b FROM Board b WHERE b.title = '" + title + "'")
```

#### 2. XSS ë°©ì§€
**ë°©ë²•**: DTO ë³€í™˜ ì‹œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬

**ìœ„ì¹˜**: `domain/board/converter/BoardConverter.java`

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/board/converter/BoardConverter.java
public BoardDTO toDTO(Board board) {
    return BoardDTO.builder()
        .title(escapeHtml(board.getTitle()))
        .content(escapeHtml(board.getContent()))
        .build();
}

private String escapeHtml(String input) {
    if (input == null) return null;
    return input
        .replace("&", "&amp;")
        .replace("<", "&lt;")
        .replace(">", "&gt;")
        .replace("\"", "&quot;")
        .replace("'", "&#x27;");
}
```

#### 3. Directory Traversal ë°©ì§€
**ìœ„ì¹˜**: `domain/file/service/FileService.java`

**ë°©ë²•**: ê²½ë¡œ ì •ê·œí™” ë° ê²€ì¦

**ì½”ë“œ ì˜ˆì‹œ**:
```java
// domain/file/service/FileService.java
public String normalizePath(String path) {
    Path normalized = Paths.get(path).normalize();
    
    // ìƒìœ„ ë””ë ‰í† ë¦¬ ì ‘ê·¼ ë°©ì§€
    if (normalized.startsWith("..")) {
        throw new IllegalArgumentException("Invalid path");
    }
    
    return normalized.toString();
}
```

---

## ğŸ“ í•µì‹¬ ì •ë¦¬

### JWT ì¸ì¦
- **Access Token**: 15ë¶„ ë§Œë£Œ
- **Refresh Token**: 1ì¼ ë§Œë£Œ, DB ì €ì¥
- **í•„í„°**: JwtAuthenticationFilterì—ì„œ ê²€ì¦
- **íš¨ê³¼**: Stateless ì¸ì¦

### OAuth2 ì†Œì…œ ë¡œê·¸ì¸
- **Provider**: Google, Naver
- **ì»¤ìŠ¤í…€ í´ë¼ì´ì–¸íŠ¸**: NaverOAuth2TokenResponseClient
- **ìë™ íšŒì›ê°€ì…**: ê¸°ì¡´ ê³„ì • í™•ì¸ í›„ ì—†ìœ¼ë©´ ìƒì„±
- **íš¨ê³¼**: ì‚¬ìš©ì í¸ì˜ì„± í–¥ìƒ

### ì´ë©”ì¼ ì¸ì¦
- **í† í° ì €ì¥**: Redis (TTL 24ì‹œê°„)
- **ìë™ ì¸ì¦**: ì†Œì…œ ë¡œê·¸ì¸ ì‹œ
- **ê¸°ëŠ¥ ì œí•œ**: ì¸ì¦ ì „ ì¼ë¶€ ê¸°ëŠ¥ ì œí•œ
- **íš¨ê³¼**: ìŠ¤íŒ¸ ê³„ì • ë°©ì§€

### ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
- **ë°©ì‹**: BCryptPasswordEncoder
- **Salt**: ìë™ ìƒì„±
- **íŠ¹ì§•**: ë‹¨ë°©í–¥ í•´ì‹œ, ëŠë¦° í•´ì‹œ í•¨ìˆ˜
- **íš¨ê³¼**: ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ë°©ì§€

### RBAC
- **Role**: USER, ADMIN, SERVICE_PROVIDER, MASTER
- **ê²½ë¡œë³„ ê¶Œí•œ**: SecurityConfig
- **ë©”ì„œë“œ ë ˆë²¨**: @PreAuthorize
- **íš¨ê³¼**: ì„¸ë°€í•œ ê¶Œí•œ ì œì–´

### ë³´ì•ˆ ê³µê²© ë°©ì§€
- **SQL Injection**: JPA PreparedStatement
- **XSS**: HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
- **Directory Traversal**: ê²½ë¡œ ì •ê·œí™”
- **íš¨ê³¼**: ë‹¤ì–‘í•œ ê³µê²© ë°©ì§€
